<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS SHORTS - Quick Entertainment</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Futuristic Navigation -->
    <nav class="futuristic-nav">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-icon">üé¨</span>
                <span class="logo-text">NEXUS</span>
            </div>
            <div class="nav-user-section">
                <span id="user-greeting" class="user-greeting">Guest</span>
                <button id="theme-toggle" class="theme-toggle-btn" title="Toggle Dark/Light Mode">üåô</button>
                <button id="upload-btn" class="upload-btn" title="Upload Video">üì§ Upload</button>
                <button id="auth-toggle" class="auth-toggle-btn">Login</button>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link" data-icon="üè†">
                        <span class="nav-icon">üè†</span>
                        <span class="nav-text">Home</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="shorts.html" class="nav-link active" data-icon="‚ö°">
                        <span class="nav-icon">‚ö°</span>
                        <span class="nav-text">Shorts</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="live.html" class="nav-link" data-icon="üì°">
                        <span class="nav-icon">üì°</span>
                        <span class="nav-text">Live</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="long.html" class="nav-link" data-icon="üé•">
                        <span class="nav-icon">üé•</span>
                        <span class="nav-text">Movies</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="kids.html" class="nav-link" data-icon="üé®">
                        <span class="nav-icon">üé®</span>
                        <span class="nav-text">Kids</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="account.html" class="nav-link" data-icon="üë§">
                        <span class="nav-icon">üë§</span>
                        <span class="nav-text">Profile</span>
                        <span class="nav-glow"></span>
                    </a>
                </li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <h1 class="main-heading">
        <span class="heading-glow">‚ö° NEXUS SHORTS</span>
        <span class="heading-sub">Quick Entertainment Bites</span>
    </h1>

    <section id="video-container" class="video-section">
        <div id="videos-grid" class="videos-grid shorts-grid"></div>
    </section>

    <section id="join">
        <a id="button" href="https://chat.whatsapp.com/JCIpz9XkxsTCIvi0Gg8WEE" target="_blank" rel="noopener noreferrer">join us</a>
        <a id="button2" class="link-button" href="https://chat.whatsapp.com/GC8GGZa4FeIHP1Wz8iheV8" target="_blank" rel="noopener noreferrer">join group 2</a>
        <a id="button3" class="link-button" href="https://whatsapp.com/channel/0029VbBv1fxBKfi72JZzbz3u" target="_blank" rel="noopener noreferrer">join channel</a>
    </section>

    <!-- Comment Modal -->
    <div id="comment-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Comments</h2>
            <div id="comments-list" class="comments-list"></div>
            <textarea id="comment-input" placeholder="Write your comment..." class="comment-input"></textarea>
            <button id="post-comment-btn" class="cyber-button">Post Comment</button>
        </div>
    </div>

    <script>
        const videosDatabase = [
            {
                id: 101,
                title: "Epic Action Moments",
                description: "The best action sequences captured in 60 seconds.",
                videoUrl: "https://www.youtube.com/embed/SHmb1u2XfGQ",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "150MB", url: "https://www.youtube.com/watch?v=SHmb1u2XfGQ" },
                    { quality: "480p", size: "75MB", url: "https://www.youtube.com/watch?v=SHmb1u2XfGQ" }
                ]
            },
            {
                id: 102,
                title: "Mind-Bending Moments",
                description: "Twists that will blow your mind.",
                videoUrl: "https://www.youtube.com/embed/k8D8SrUxfzc",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "140MB", url: "https://www.youtube.com/watch?v=k8D8SrUxfzc" },
                    { quality: "480p", size: "70MB", url: "https://www.youtube.com/watch?v=k8D8SrUxfzc" }
                ]
            },
            {
                id: 103,
                title: "Comedy Gold",
                description: "Hilarious moments that had us laughing.",
                videoUrl: "https://www.youtube.com/embed/dQw4w9WgXcQ",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "130MB", url: "https://www.youtube.com/watch?v=dQw4w9WgXcQ" },
                    { quality: "480p", size: "65MB", url: "https://www.youtube.com/watch?v=dQw4w9WgXcQ" }
                ]
            },
            {
                id: 104,
                title: "Emotional Roller Coaster",
                description: "Unforgettable emotional scenes.",
                videoUrl: "https://www.youtube.com/embed/QcISpHeotQs",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "155MB", url: "https://www.youtube.com/watch?v=QcISpHeotQs" },
                    { quality: "480p", size: "78MB", url: "https://www.youtube.com/watch?v=QcISpHeotQs" }
                ]
            },
            {
                id: 105,
                title: "Visual Spectacle",
                description: "Stunning cinematography and effects.",
                videoUrl: "https://www.youtube.com/embed/DL7-IQOrKKk",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "160MB", url: "https://www.youtube.com/watch?v=DL7-IQOrKKk" },
                    { quality: "480p", size: "80MB", url: "https://www.youtube.com/watch?v=DL7-IQOrKKk" }
                ]
            },
            {
                id: 106,
                title: "Plot Twists",
                description: "Unexpected turns in the story.",
                videoUrl: "https://www.youtube.com/embed/Y_XqZ9gKxQI",
                source: "YouTube",
                downloads: [
                    { quality: "720p", size: "145MB", url: "https://www.youtube.com/watch?v=Y_XqZ9gKxQI" },
                    { quality: "480p", size: "72MB", url: "https://www.youtube.com/watch?v=Y_XqZ9gKxQI" }
                ]
            }
        ];

        // Video Manager Class
        class VideoManager {
            constructor() {
                this.storageKey = 'videoAppData';
                this.initializeStorage();
            }

            initializeStorage() {
                if (!localStorage.getItem(this.storageKey)) {
                    localStorage.setItem(this.storageKey, JSON.stringify({
                        likes: {},
                        comments: {},
                        watchlist: []
                    }));
                }
            }

            getLikes(videoId) {
                const data = JSON.parse(localStorage.getItem(this.storageKey));
                return data.likes[videoId] || { count: 0, liked: false };
            }

            toggleLike(videoId) {
                const data = JSON.parse(localStorage.getItem(this.storageKey));
                if (!data.likes[videoId]) {
                    data.likes[videoId] = { count: 0, liked: false };
                }
                
                if (data.likes[videoId].liked) {
                    data.likes[videoId].count--;
                    data.likes[videoId].liked = false;
                } else {
                    data.likes[videoId].count++;
                    data.likes[videoId].liked = true;
                }
                
                localStorage.setItem(this.storageKey, JSON.stringify(data));
                return data.likes[videoId];
            }

            getComments(videoId) {
                const data = JSON.parse(localStorage.getItem(this.storageKey));
                return data.comments[videoId] || [];
            }

            addComment(videoId, comment) {
                const data = JSON.parse(localStorage.getItem(this.storageKey));
                if (!data.comments[videoId]) {
                    data.comments[videoId] = [];
                }

                const newComment = {
                    id: Date.now(),
                    author: `User ${Math.floor(Math.random() * 1000)}`,
                    text: comment,
                    timestamp: new Date().toLocaleTimeString()
                };

                data.comments[videoId].push(newComment);
                localStorage.setItem(this.storageKey, JSON.stringify(data));
                return newComment;
            }
        }

        const videoManager = new VideoManager();
        let currentVideoId = null;

        function initializeVideosGrid() {
            const grid = document.getElementById('videos-grid');
            grid.innerHTML = '';

            videosDatabase.forEach(video => {
                const likes = videoManager.getLikes(video.id);
                const videoCard = createVideoCard(video, likes);
                grid.appendChild(videoCard);
            });
        }

        function createVideoCard(video, likes) {
            const card = document.createElement('div');
            card.className = 'video-card';
            
            const isLiked = likes.liked ? 'liked' : '';

            card.innerHTML = `
                <div class="video-player">
                    <iframe src="${video.videoUrl}" allowfullscreen="" loading="lazy"></iframe>
                </div>
                <div class="video-info">
                    <h3 class="video-title">${video.title}</h3>
                    <p class="video-description">${video.description}</p>
                    <div class="video-actions">
                        <button class="action-btn like-btn ${isLiked}" data-video-id="${video.id}">
                            <span>‚ù§Ô∏è</span>
                            <span class="like-count">${likes.count}</span>
                        </button>
                        <button class="action-btn download-btn" data-video-id="${video.id}">
                            <span>‚¨áÔ∏è</span>
                            <span>Download</span>
                        </button>
                        <button class="action-btn comment-btn" data-video-id="${video.id}">
                            <span>üí¨</span>
                            <span>Comment</span>
                        </button>
                    </div>
                </div>
            `;

            const likeBtn = card.querySelector('.like-btn');
            likeBtn.addEventListener('click', () => handleLike(video.id, likeBtn));

            const downloadBtn = card.querySelector('.download-btn');
            downloadBtn.addEventListener('click', () => handleDownload(video.id));

            const commentBtn = card.querySelector('.comment-btn');
            commentBtn.addEventListener('click', () => openCommentModal(video.id, video.title));

            return card;
        }

        function handleLike(videoId, button) {
            const likes = videoManager.toggleLike(videoId);
            
            button.classList.toggle('liked');
            const countSpan = button.querySelector('.like-count');
            countSpan.textContent = likes.count;

            showToast(likes.liked ? '‚ù§Ô∏è Video Liked!' : 'üíî Like Removed');
        }

        function handleDownload(videoId) {
            const video = videosDatabase.find(v => v.id === videoId);
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'download-modal';
            
            let downloadHTML = '<div class="modal-content"><span class="close">&times;</span>';
            downloadHTML += `<h2>üì• Download - ${video.title}</h2>`;
            downloadHTML += '<div class="download-options">';
            
            video.downloads.forEach(download => {
                downloadHTML += `
                    <div class="download-item">
                        <button class="download-quality-btn" data-url="${download.url}" data-quality="${download.quality}" data-title="${video.title}">
                            <div class="download-info">
                                <span class="quality-name">üì• ${download.quality}</span>
                                <span class="quality-size">${download.size}</span>
                            </div>
                            <span class="download-arrow">‚Üí</span>
                        </button>
                    </div>
                `;
            });
            
            downloadHTML += '</div></div>';
            modal.innerHTML = downloadHTML;
            document.body.appendChild(modal);

            const closeBtn = modal.querySelector('.close');
            closeBtn.addEventListener('click', () => {
                modal.remove();
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });

            const qualityBtns = modal.querySelectorAll('.download-quality-btn');
            qualityBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const url = e.currentTarget.getAttribute('data-url');
                    const quality = e.currentTarget.getAttribute('data-quality');
                    const title = e.currentTarget.getAttribute('data-title');
                    
                    downloadVideo(title, quality, url);
                    showToast(`‚¨áÔ∏è Opening ${quality} download...`);
                    setTimeout(() => {
                        modal.remove();
                    }, 1000);
                });
            });
        }

        function downloadVideo(title, quality, videoUrl) {
            const link = document.createElement('a');
            link.href = videoUrl;
            link.target = '_blank';
            link.download = `${title}_${quality}.mp4`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            const data = JSON.parse(localStorage.getItem('videoAppData'));
            if (!data.downloads) {
                data.downloads = [];
            }
            data.downloads.push({
                title: title,
                quality: quality,
                timestamp: new Date().toLocaleString(),
                size: quality === '720p' ? '140MB' : '70MB'
            });
            localStorage.setItem('videoAppData', JSON.stringify(data));
        }

        function openCommentModal(videoId, videoTitle) {
            currentVideoId = videoId;
            const modal = document.getElementById('comment-modal');
            modal.classList.add('active');

            loadComments(videoId);

            const postBtn = document.getElementById('post-comment-btn');
            postBtn.onclick = () => postComment(videoId);

            const closeBtn = modal.querySelector('.close');
            closeBtn.onclick = () => {
                modal.classList.remove('active');
            };

            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            };
        }

        function loadComments(videoId) {
            const commentsList = document.getElementById('comments-list');
            const comments = videoManager.getComments(videoId);

            commentsList.innerHTML = '';

            if (comments.length === 0) {
                commentsList.innerHTML = '<p style="color: #00ffff; text-align: center;">No comments yet. Be the first!</p>';
                return;
            }

            comments.forEach(comment => {
                const commentDiv = document.createElement('div');
                commentDiv.className = 'comment-item';
                commentDiv.innerHTML = `
                    <div class="comment-author">${comment.author}</div>
                    <div class="comment-text">${comment.text}</div>
                    <div class="comment-time">${comment.timestamp}</div>
                `;
                commentsList.appendChild(commentDiv);
            });
        }

        function postComment(videoId) {
            const input = document.getElementById('comment-input');
            const comment = input.value.trim();

            if (comment === '') {
                showToast('‚ö†Ô∏è Comment cannot be empty!');
                return;
            }

            videoManager.addComment(videoId, comment);
            input.value = '';

            loadComments(videoId);
            showToast('üí¨ Comment Posted!');
        }

        function showToast(message) {
            let toast = document.getElementById('toast');
            
            if (!toast) {
                toast = document.createElement('div');
                toast.id = 'toast';
                toast.className = 'toast';
                document.body.appendChild(toast);
            }

            toast.textContent = message;
            toast.classList.add('visible');

            setTimeout(() => {
                toast.classList.remove('visible');
            }, 3000);
        }

        function addDownloadModalStyles() {
            const style = document.createElement('style');
            style.textContent = `
                .shorts-grid {
                    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                }

                @media (max-width: 768px) {
                    .shorts-grid {
                        grid-template-columns: 1fr;
                    }

                    .video-player {
                        height: 400px;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeVideosGrid();
            addDownloadModalStyles();
        });
    </script>
</body>
<footer>
    <script src="auth.js"></script>
    <script src="theme.js"></script>
    <script src="upload.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize user greeting and auth UI
        document.addEventListener('DOMContentLoaded', function() {
            const userGreeting = document.getElementById('user-greeting');
            const authToggleBtn = document.getElementById('auth-toggle');
            const uploadBtn = document.getElementById('upload-btn');
            const themeToggleBtn = document.getElementById('theme-toggle');
            
            // Initialize managers
            window.themeManager = new ThemeManager();
            window.userManager = new UserManager();
            window.uploadManager = new VideoUploadManager(window.userManager);
            
            // Update user greeting
            const currentUser = userManager.getCurrentUser();
            if (currentUser) {
                userGreeting.textContent = `üë§ ${currentUser.username}`;
                authToggleBtn.textContent = 'Logout';
            } else {
                userGreeting.textContent = 'Guest';
                authToggleBtn.textContent = 'Login';
            }
            
            // Auth toggle button
            authToggleBtn.addEventListener('click', function() {
                if (userManager.getCurrentUser()) {
                    // Show logout confirmation
                    if (confirm('Are you sure you want to logout?')) {
                        userManager.logout();
                        userGreeting.textContent = 'Guest';
                        authToggleBtn.textContent = 'Login';
                        location.reload();
                    }
                } else {
                    alert('Redirecting to login page...');
                    window.location.href = 'index.html';
                }
            });
            
            // Theme toggle
            themeToggleBtn.addEventListener('click', function() {
                themeManager.toggleTheme();
                themeToggleBtn.textContent = themeManager.currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            });
            
            // Upload button
            uploadBtn.addEventListener('click', function() {
                const user = userManager.getCurrentUser();
                if (!user) {
                    alert('Please login first to upload videos');
                    window.location.href = 'index.html';
                } else {
                    uploadManager.createUploadModal();
                }
            });
            
            // Initialize videos
            initializeVideosGrid();
            addDownloadModalStyles();
        });
    </script>
</footer>
</html>